/**
 * -------------------------------------------------------------------------------------------------
 * @author  Ryan Sullivan (ryansullivan@googlemail.com)
 *
 * @file    io.c
 * @brief   General purpose io.
 *
 * @date    2021-07-18
 * -------------------------------------------------------------------------------------------------
 */

#include "types.h"

#include "io.h"
#include "usart.h"
#include "port.h"

/*------------------------------------------------------------------------------------------------*/
/*-constant-definitions---------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------*/

#define LED      PORT_A3

#define USART_TX PORT_B2
#define USART_RX PORT_B3

/*------------------------------------------------------------------------------------------------*/
/*-exported-variables-----------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------*/

/*------------------------------------------------------------------------------------------------*/
/*-static-variables-------------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------*/

/*------------------------------------------------------------------------------------------------*/
/*-forward-declarations---------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------*/

void initialise_pins(void);

/*------------------------------------------------------------------------------------------------*/
/*-exported-functions-----------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------*/

/**
 * @brief   Initialise peripherls.
 */
void io_initialise(void)
{
    initialise_pins();

    usart_initialise(9600);
}

/*------------------------------------------------------------------------------------------------*/

/**
 * @brief   Turn on the LED.
 */
void io_led_on(void)
{
    port_clear(LED);
}

/*------------------------------------------------------------------------------------------------*/

/**
 * @brief   Turn off the LED.
 */
void io_led_off(void)
{
    port_set(LED);
}

/*------------------------------------------------------------------------------------------------*/
/*-static-functions-------------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------*/

void initialise_pins(void)
{
    io_led_off();
    port_initialise(LED, PORT_MODE_OUTPUT_PUSH_PULL);

    port_initialise(USART_TX, PORT_MODE_OUTPUT_PUSH_PULL);
    port_initialise(USART_RX, PORT_MODE_INPUT);
}

/*------------------------------------------------------------------------------------------------*/
/*-end-of-module----------------------------------------------------------------------------------*/
/*------------------------------------------------------------------------------------------------*/
